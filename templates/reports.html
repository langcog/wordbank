{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="alert alert-dismissible alert-warning" align="center">
  <p>Wordbank is under early development, and we make no guarantees about the accuracy of its data. Use at your own risk.</p>
</div>

<div>
<ul class="nav nav-tabs" id="main-tabs">
  <li role="presentation" class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-expanded="false">
      Reports <span class="caret"></span>
    </a>
    <ul class="dropdown-menu" role="menu" id="drop-tabs">
    </ul>
  </li>
</ul>
</div>

<div id="wait" class="loader" align="center">
    <p class="lead" style="margin-top:100px;">Please wait...</p>
    <img src="{% static 'images/loading.gif' %}">
</div>

<div id="content">
<!--    <iframe style="border:none; width:1100px; height:1000px" id="report"  src="http://{{ shinyServerIP }}/{{ id }}"></iframe> -->
    <iframe style="border:none; width:1100px; height:1500px" id="report"  src="{{ source }}"></iframe>
</div>

<script>
    $('#content').hide();

    var displayReport = function() {
        console.log('loaded!');
        $('#wait').hide();
	    $('#content').show();
    }

    $('#report').load(function() {
        displayReport();
    });
</script>

<script>
    $.getJSON("static/json/reports.json", function(data) {
	var currentApp = window.location.search.split('=')[1];
        var main = $('#main-tabs');
        var menu = $('#drop-tabs');
        for (var i in data) {
            var app = data[i];
            if (app['type'] == 'reports') {
                var li = $('<li>').attr('role', "presentation").prependTo(menu)
            } else {
                var li = $('<li>').attr('role', "presentation").prependTo(main)
            }
            if (app['name'] == currentApp) {
                li.attr('class', "active");
            }
            var link = $('<a>').attr('href', '/reports?name=' + app['name']).text(app['title']).appendTo(li);
        };
    }).error(function(error){console.log(error);}).fail(function(){console.log(arguments);})
</script>

{% endblock %}